<!DOCTYPE html>
<html>
<head>
    <title>Bundt Cake Order</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body { font-family: Arial, sans-serif; text-align: center; padding: 20px; }
        .hidden { display: none; }
        .cake-option { margin: 10px 0; }
        button { padding: 10px 20px; font-size: 16px; margin-top: 20px; cursor: pointer; }
    </style>
</head>
<body>

<h1>Bundt Cake Order</h1>

<!-- Step 1: Name & Email -->
<div id="infoSection">
    <h2>Your Information</h2>
    <input type="text" id="name" placeholder="Your Name" required><br><br>
    <input type="email" id="email" placeholder="Your Email" required><br><br>
</div>

<!-- Step 2: Pick Flavors -->
<div id="flavorSection">
    <h2>Select Bundt Cake Flavors ($8 each)</h2>

    <div class="cake-option">Red Velvet <input type="number" min="0" value="0" id="redvelvet"></div>
    <div class="cake-option">Confetti <input type="number" min="0" value="0" id="confetti"></div>
    <div class="cake-option">Lemon <input type="number" min="0" value="0" id="lemon"></div>
    <div class="cake-option">Chocolate Chocolate Chip <input type="number" min="0" value="0" id="chocochocchip"></div>
    <div class="cake-option">White Chocolate Raspberry <input type="number" min="0" value="0" id="whitechocrasp"></div>
    <div class="cake-option">Classic Vanilla <input type="number" min="0" value="0" id="vanilla"></div>
    <div class="cake-option">Strawberries & Cream <input type="number" min="0" value="0" id="strawcream"></div>
    <div class="cake-option">Carrot <input type="number" min="0" value="0" id="carrot"></div>
    <div class="cake-option">Oreo Cookies n Cream <input type="number" min="0" value="0" id="oreo"></div>
    <div class="cake-option">GF Chocolate Chip Cookie <input type="number" min="0" value="0" id="gfchocchip"></div>
    <div class="cake-option">GF Lemon Raspberry <input type="number" min="0" value="0" id="gflemonrasp"></div>

    <button onclick="submitOrder()">Submit Order</button>
</div>

<!-- Step 3: Confirmation -->
<div id="thankyouSection" class="hidden">
    <h2>Thank you!</h2>
    <p>Your order has been recorded. Please complete your payment.</p>
    <button onclick="goToPayment()">Pay with Cash App</button>
</div>

<script>
const pricePerCake = 8;

function submitOrder() {
    const name = document.getElementById("name").value.trim();
    const email = document.getElementById("email").value.trim();

    if(!name || !email){
        alert("Please enter your name and email.");
        return;
    }

    const flavors = {
        "Red Velvet": parseInt(document.getElementById("redvelvet").value) || 0,
        "Confetti": parseInt(document.getElementById("confetti").value) || 0,
        "Lemon": parseInt(document.getElementById("lemon").value) || 0,
        "Chocolate Chocolate Chip": parseInt(document.getElementById("chocochocchip").value) || 0,
        "White Chocolate Raspberry": parseInt(document.getElementById("whitechocrasp").value) || 0,
        "Classic Vanilla": parseInt(document.getElementById("vanilla").value) || 0,
        "Strawberries & Cream": parseInt(document.getElementById("strawcream").value) || 0,
        "Carrot": parseInt(document.getElementById("carrot").value) || 0,
        "Oreo Cookies n Cream": parseInt(document.getElementById("oreo").value) || 0,
        "GF Chocolate Chip Cookie": parseInt(document.getElementById("gfchocchip").value) || 0,
        "GF Lemon Raspberry": parseInt(document.getElementById("gflemonrasp").value) || 0
    };

    let totalQuantity = 0;
    for(let key in flavors){
        totalQuantity += flavors[key];
    }

    if(totalQuantity === 0){
        alert("Please select at least one cake.");
        return;
    }

    const totalPrice = totalQuantity * pricePerCake;

    // Save order to GitHub via Action
    fetch("https://api.github.com/repos/66alexisw/bundt-cake-order/dispatches", {
        method: "POST",
        headers: {
            "Accept": "application/vnd.github.v3+json",
            // A GitHub personal access token with "repo" permission is required here
            "Authorization": "token YOUR_GITHUB_TOKEN"
        },
        body: JSON.stringify({
            event_type: "new_order",
            client_payload: {
                name: name,
                email: email,
                flavors: flavors,
                total: totalPrice
            }
        })
    }).then(() => {
        document.getElementById("flavorSection").classList.add("hidden");
        document.getElementById("thankyouSection").classList.remove("hidden");
    }).catch(err => {
        alert("Error saving order. Check GitHub Actions setup.");
        console.error(err);
    });

    window.orderTotal = totalPrice; // store total for payment
}

function goToPayment() {
    const cashAppLink = "YOUR_CASHAPP_LINK"; // replace with your Cash App link
    window.location.href = cashAppLink;
}
</script>

</body>
</html>
